<html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Pux</title><link rel="icon" type="image/x-icon" href="../../favicon.ico"><link rel="stylesheet" href="../../css"><link rel="stylesheet" type="text/css" href="../../atom-one-dark.css"><style></style></head><body><div id="app"><div><style>body { margin: 0.0px 0.0px 0.0px 0.0px ; padding: 0.0px 0.0px 0.0px 0.0px ; background-color: hsl(0.0, 0.0%, 99.22%); font-size: 15.0px; font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif; line-height: 165.0%; color: hsl(220.0, 6.47%, 27.25%) }
.strong { font-weight: bolder }
blockquote { background-color: hsl(0.0, 0.0%, 98.04%); overflow: auto; margin: 0.0px 0.0px 1.5em 0.0px ; width: 100.0% }
blockquote p { margin: 0.0em 0.0px 0.0px 0.0px ; border-left: solid 4.0px hsl(0.0, 0.0%, 86.27%) ; padding: 1.0em 0.0px 1.0em 24.0px  }
blockquote h4 { margin: 1.0em 0.0px 0.0px 0.0px ; text-align: right }
blockquote h4:nth-child(1) { display: inline-block; padding: 1.0em 24.0px 1.0em 0.0px ; border-right: solid 4.0px hsl(0.0, 0.0%, 86.27%) ; float: right; text-align: right }
blockquote h4:nth-child(2) { border-left: solid 4.0px hsl(0.0, 0.0%, 86.27%) ; padding: 1.0em 0.0px 1.0em 24.0px ; display: inline-block; float: left }
hr { background-color: hsl(0.0, 0.0%, 86.27%); height: 1.0px; border: solid 0.0px hsl(0.0, 0.0%, 86.27%)  }
h1, h2, h3, h4 { line-height: 140.0% }
h1 { font-size: 28.0px; margin: 0.0px 0.0px 1.0em 0.0px  }
h2 { font-size: 21.0px; margin: 1.6em 0.0px 0.7em 0.0px  }
h3 { font-size: 17.0px; margin: 1.8em 0.0px 0.7em 0.0px  }
h4 { font-size: 17.0px; margin: 2.0em 0.0px 0.7em 0.0px  }
h4 code { font-size: 21.0px }
ul { padding: 0.0px 0.0px 0.0px 24.0px  }
ol { padding: 0.0px 0.0px 0.0px 24.0px  }
a { color: hsl(240.69, 55.41%, 69.22%); text-decoration: none }
a:hover { color: hsl(158.02, 56.22%, 54.31%); text-decoration: none }
li code { height: 17.0px; line-height: 17.0px; padding: 0.0px 4.0px 0.0px 4.0px  }
p code { padding: 0.0px 4.0px 0.0px 4.0px  }
code { display: inline-block; border-radius: 2.0px 2.0px 2.0px 2.0px ; line-height: 1.6em; font-size: 14.0px; max-width: 720.0px; background-color: hsl(0.0, 0.0%, 96.08%) }
pre code { display: block; background-color: hsl(306.67, 9.89%, 17.84%); color: hsl(312.0, 6.17%, 84.12%); overflow: auto; padding: 12.0px 12.0px 12.0px 12.0px  }
p { margin: 0.0px 0.0px 1.0em 0.0px ; max-width: 720.0px }
.main { position: absolute; left: 248.0px; right: 0.0px; top: 0.0px; bottom: 0.0px; overflow: auto }
.main .inner { padding: 48.0px 48.0px 16.0px 60.0px  }
.main h1 { line-height: 100.0%; margin-top: 0.0px }
.main li { font-size: 15.0px; margin: 0.3em 0.0px 0.3em 0.0px ; list-style-type: none }
.main li:before { font-size: 11.0px; margin-right: 6.0px; vertical-align: top }
.main ol { counter-reset: item }
.main ol li:before { color: hsl(220.0, 6.47%, 47.25%); content: counter(item) ". "; counter-increment: item }
.main ul li:before { color: hsl(220.0, 6.47%, 87.25%); content: "★" }
.homepage .main ul { font-size: 17.0px }
@media screen and (max-width: 720.0px) { .main { position: relative; right: 0.0px; top: 0.0px; left: 0.0px }
.main .inner { padding: 48.0px 36.0px 16.0px 36.0px  }
 }
</style><div class="guidepage"><style>.sidebar { background-color: hsl(220.0, 13.04%, 18.04%); position: absolute; left: 0.0px; top: 0.0px; bottom: 0.0px; width: 248.0px }
.sidebar h2 { letter-spacing: 1.0px; margin: 0.0px 0.0px 32.0px 0.0px ; padding-left: 15.0px; line-height: 100.0%; text-transform: uppercase }
.sidebar h2 a { color: hsl(0.0, 0.0%, 96.08%) }
.sidebar li a { border-left: solid 3.0px hsl(220.0, 13.04%, 18.04%) ; padding-left: 12.0px; color: hsl(0.0, 0.0%, 96.08%); font-weight: lighter }
.sidebar a:hover { color: hsl(157.99, 64.65%, 57.84%) }
.sidebar .selected { border-left: solid 3.0px hsl(157.99, 64.65%, 57.84%)  }
.sidebar .inner { margin-left: 24.0px; padding: 52.0px 16.0px 16.0px 16.0px  }
.sidebar ul { list-style-type: none; margin-top: 0.0px; padding-left: 0.0px }
.sidebar ul ul li a { padding-left: 24.0px }
@media screen and (max-width: 720.0px) { .sidebar { position: relative; top: 0.0px; width: 100.0% }
 }
</style><nav class="sidebar"><div class="inner"><h2><a href="/">Pux</a></h2><ul><li></li><li><a href="/">Introduction</a></li><li></li><li><a href="/docs/architecture">Architecture</a></li><li></li><li><a class="selected" href="/docs/events">Events</a></li><li></li><li><a href="/docs/markup">Markup</a></li><li></li><li><a href="/docs/rendering">Rendering</a></li><li></li><li><a href="/docs/components">Components</a></li><li></li><li><a href="/docs/forms">Forms</a></li><li></li><li><a href="/docs/routing">Routing</a></li><li></li><li><a href="/docs/css">CSS</a></li><li></li><li><a href="/docs/react-interop">React Interop</a></li></ul><ul><li></li><li><a href="https://pursuit.purescript.org/packages/purescript-pux">API Reference</a></li><li></li><li><a href="https://github.com/alexmingoia/purescript-pux/tree/master/examples/">Examples</a></li><li></li><li><a href="https://github.com/alexmingoia/pux-devtool">Devtool Extension</a></li></ul><ul><li></li><li><a href="https://github.com/alexmingoia/purescript-pux/">GitHub</a></li><li></li><li><a href="https://gitter.im/alexmingoia/purescript-pux">Chat (Gitter)</a></li></ul><ul><li></li><li><a href="/docs/learn-purescript">Learn PureScript</a></li></ul></div></nav><div class="main"><div class="inner"><h1 id="Events">Events</h1><p>Pux listens for DOM events and reifies them using the application's event type.
For example, a simple counter needs events for incrementing and decrementing in
response to clicking buttons:</p><pre><code>data Event = Increment | Decrement</code></pre><p>When raw DOM events are needed, they can be wrapped by the application event
type:</p><pre><code>data Event = Increment DOMEvent | Decrement DOMEvent</code></pre><p><code>DOMEvent</code> from Pux.DOM.Events is a type alias for
<a href="https://pursuit.purescript.org/packages/purescript-dom">purescript-dom</a>'s event
type.</p><h2 id="Folding_over_the_past_with_foldp">Folding over the past with foldp</h2><p>Whenever an event occurs a new state is produced by folding it with the current
state. This function is called <strong>foldp</strong> and is analogous to foldl, but
instead of folding from left to right it folds from past to present. Continuing
the counter example, the previous count is combined with the current event to
produce a new count:</p><pre><code>foldp :: Event -&gt; State -&gt; EffModel State Event
foldp Increment n = { state: n + 1, effects: [] }
foldp Decrement n = { state: n - 1, effects: [] }</code></pre><h3 id="The_EffModel">The EffModel</h3><p>foldp produces a new state along with effects. These are wrapped in a record
that Pux calls an
<a href="https://pursuit.purescript.org/packages/purescript-pux/9.0.0/docs/Pux#t:EffModel"><code>EffModel</code></a>.</p><pre><code>type EffModel st ev =
  { state   :: st
  , effects :: Array (Aff (Maybe ev))
  }</code></pre><h3 id="Effectful_computations">Effectful computations</h3><p>Effectful computations returned by foldp are asynchronous and handled by the
<code>Aff</code> monad from
<a href="https://pursuit.purescript.org/packages/purescript-aff">purescript-aff</a>. These
computations may return new events which are again handled by foldp.</p><p>For example, to log to the console when an event occurs we can use
purescript-aff's <code>log</code>:</p><pre><code>foldp :: Event -&gt; State -&gt; EffModel State Event (console :: CONSOLE)
foldp Increment count =
  { state: count + 1
  , effects: [ log &quot;increment&quot; *&gt; pure Nothing ]
  }</code></pre><p>Returning <code>Nothing</code> after logging denotes that the computation does not generate a new event.</p><p>Some effectful computations return a value and new event. For example, an HTTP
request to remotely load todos might have an event <code>RequestTodos</code>. When this
event occurs <code>foldp</code> returns an effect – the AJAX request – which returns a new
event <code>ReceiveTodos</code>:</p><pre><code>foldp :: Event -&gt; State -&gt; EffModel State Event
foldp (RequestTodos) st =
  { state: st { status = &quot;Fetching todos...&quot; }
  , effects: [ do
      res &lt;- attempt $ get &quot;http://jsonplaceholder.typicode.com/users/1/todos&quot;
      let todos = either (Left &lt;&lt;&lt; show) (decodeJson res.response :: Either String Todos)
      pure $ Just $ ReceiveTodos todos
    ]
  }

foldp (ReceiveTodos t) st =
  noEffects $ case t of
    Left err -&gt; st { status = &quot;Error fetching todos: &quot; &lt;&gt; show err }
    Right todos -&gt; st { todos = todos, status = &quot;&quot; }</code></pre><h3 id="Nesting_events">Nesting events</h3><blockquote><p>Read the <a href="/docs/components">Components</a> section to learn more
about organizing your app.</p></blockquote><p>Sometimes you want to compose foldp functions with different event and state
types when using external libraries or splitting your foldp function into
submodules. To do this, create a parent event type wrapping the child's type and
embed the child state in the parent state:</p><pre><code>-- | Wrap the child event type
data Event
  = PageView Route
  | ChildEvent Child.Event

-- | Extend the state with the child's state
type State =
  { route :: Route
  , child :: Child.State
  }</code></pre><p>Whenever a child event occurs pass it to the child's foldp function, then map
over the returned EffModel using Pux's
<a href="https://pursuit.purescript.org/packages/purescript-pux/9.0.0/docs/Pux#v:mapEffects"><code>mapEffects</code></a>
and <a href="https://pursuit.purescript.org/packages/purescript-pux/9.0.0/docs/Pux#v:mapState"><code>mapState</code></a>:</p><pre><code>foldp :: Event -&gt; State -&gt; EffModel State Event
foldp (PageView r) st = noEffects $ st { route = r }
foldp (ChildEvent e) st =
  Child.foldp e st.child
    # mapEffects ChildEvent
    # mapState \sb -&gt; st { child = sb }</code></pre><blockquote><h4 id="Next_Markup">Next: <a href="/docs/markup">Markup</a></h4><h4 id="Previous_Architecture">Previous: <a href="/docs/architecture">Architecture</a></h4></blockquote></div></div></div></div></div><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></body></html>